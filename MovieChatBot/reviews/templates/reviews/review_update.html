{% extends "base.html" %}

{% block content %}

<div class="form-container">
    <h3 class="form-title">리뷰 수정</h3>
    <p class="form-subtitle">영화에 대한 정보를 업데이트해보세요</p>

    <form action="{% url 'reviews:review_update' review.id %}" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        
        <div class="form-row">
            <div class="form-group half">
                <label for="title" class="form-label">영화 제목</label>
                <input 
                    type="text" 
                    id="title"
                    name="title" 
                    value="{{ review.title }}" 
                    placeholder="영화 제목을 입력하세요" 
                    class="form-input" 
                    required 
                />
            </div>
            <div class="form-group half">
                <label for="release_year" class="form-label">개봉 년도</label>
                <input 
                    type="text" 
                    id="release_year"
                    name="release_year" 
                    value="{{ review.release_year }}" 
                    placeholder="개봉 년도 (예: 2024)" 
                    class="form-input" 
                    required 
                />
            </div>
        </div>

        <div class="form-row">
    <div class="form-group half">
        <label for="director" class="form-label">감독</label>
        <input 
            type="text" 
            id="director"
            name="director" 
            value="{{ review.director }}" 
            placeholder="감독 이름을 입력하세요" 
            class="form-input" 
            required 
        />
    </div>
    <div class="form-group half">
        <label for="genre" class="form-label">장르</label>
        <select id="genre" name="genre" class="form-select" required>
            <option value="">----------</option>
            {% for g in "액션,코미디,드라마,스릴러,로맨스,SF,판타지,애니메이션,공포,다큐멘터리" %}
                {% endfor %}
            
            <option value="액션" {% if review.genre == "액션" %}selected{% endif %}>액션</option>
            <option value="코미디" {% if review.genre == "코미디" %}selected{% endif %}>코미디</option>
            <option value="드라마" {% if review.genre == "드라마" %}selected{% endif %}>드라마</option>
            <option value="스릴러" {% if review.genre == "스릴러" %}selected{% endif %}>스릴러</option>
            <option value="로맨스" {% if review.genre == "로맨스" %}selected{% endif %}>로맨스</option>
            <option value="SF" {% if review.genre == "SF" %}selected{% endif %}>SF</option>
            <option value="판타지" {% if review.genre == "판타지" %}selected{% endif %}>판타지</option>
            <option value="애니메이션" {% if review.genre == "애니메이션" %}selected{% endif %}>애니메이션</option>
            <option value="공포" {% if review.genre == "공포" %}selected{% endif %}>공포</option>
            <option value="다큐멘터리" {% if review.genre == "다큐멘터리" %}selected{% endif %}>다큐멘터리</option>
        </select>
    </div>
</div>

<div class="form-row">
    <div class="form-group half">
        <label for="runtime" class="form-label">러닝타임(분)</label>
        <input 
            type="text" 
            id="runtime"
            name="runtime" 
            value="{{ review.runtime }}" 
            placeholder="러닝타임 (분 단위)" 
            class="form-input" 
            required 
        />
    </div>
    <div class="form-group half">
        <label for="rating" class="form-label">별점</label>
        <select id="rating" name="rating" class="form-select" required>
            <option value="0.5" {% if review.rating == 0.5 %}selected{% endif %}>0.5점</option>
            <option value="1.0" {% if review.rating == 1.0 %}selected{% endif %}>1.0점</option>
            <option value="1.5" {% if review.rating == 1.5 %}selected{% endif %}>1.5점</option>
            <option value="2.0" {% if review.rating == 2.0 %}selected{% endif %}>2.0점</option>
            <option value="2.5" {% if review.rating == 2.5 %}selected{% endif %}>2.5점</option>
            <option value="3.0" {% if review.rating == 3.0 %}selected{% endif %}>3.0점</option>
            <option value="3.5" {% if review.rating == 3.5 %}selected{% endif %}>3.5점</option>
            <option value="4.0" {% if review.rating == 4.0 %}selected{% endif %}>4.0점</option>
            <option value="4.5" {% if review.rating == 4.5 %}selected{% endif %}>4.5점</option>
            <option value="5.0" {% if review.rating == 5.0 %}selected{% endif %}>5.0점</option>
        </select>
    </div>
</div>

        <div class="form-group">
            <label for="content" class="form-label">리뷰 내용</label>
            <textarea 
                id="content"
                name="content" 
                placeholder="영화에 대한 리뷰를 작성해주세요" 
                rows="8" 
                class="form-textarea" 
                required
            >{{ review.content }}</textarea>
        </div>

        <div class="form-group">
            <label for="poster" class="form-label">포스터 이미지</label>
            <div class="file-input-wrapper">
                <input 
                    type="file" 
                    id="poster"
                    name="poster" 
                    accept="image/*"
                    class="file-input"
                />
                <label for="poster" class="file-input-label">
                    파일 변경 <span class="file-name">{% if review.poster_url %}기존 이미지 사용 중{% else %}선택된 파일 없음{% endif %}</span>
                </label>
                <p class="file-input-hint">이미지를 변경하려면 새 파일을 업로드하세요.</p>
            </div>
        </div>

        <div class="form-actions">
            <a href="{% url 'reviews:review_detail' review.id %}" class="btn-cancel">취소</a>
            <button type="submit" class="btn-submit">수정 완료</button>
        </div>
    </form>
</div>

<script>


document.getElementById('poster').addEventListener('change', function(e) {
    const fileName = e.target.files[0]?.name || '선택된 파일 없음';
    document.querySelector('.file-name').textContent = fileName;
});
</script>

{% endblock content %}